{% extends "base.html" %}
{% load static %}
{% load bootstrap4 %}

{% block head_title %}{{ title }}{% endblock %}

{% block content %}


  <!-- Page Content -->
  <div class="container">

    <div class="row">

      <!-- Post Content Column -->
      <div class="col-6 mx-auto">

        <!-- Title -->
        <h1 class="mt-4">{{ post.title }}</h1>

        <!-- Author -->
        <p class="lead">
          by
          <a href="{% url 'users:profile' slug=post.posted_by.slug %}">@{{ post.posted_by }}</a><p>
        </p>

        <hr>

        <!-- Date/Time -->
        <p>Posted on {{ post.date_created }}</p>

          {% if post.image %}
            <hr>

            <!-- Preview Image -->
            <img class="img-fluid rounded" src="{{post.image}}" alt="Post Image">

          {% endif %}

        <hr>

        <!-- Post Content -->
        <p class="lead">
                {{ post.content }}
        <hr>

                         <!-- Comments Form -->


                        <div class="card my-4">
                          <h5 class="card-header">Leave a Comment</h5>
                          <div class="card-body">
                            <form action="{% url 'blog:post' post.slug %}" method="POST">{% csrf_token %}
                              <div class="form-group">

                                  {% bootstrap_field form.comment layout='inline' error_types='all' %}

                              </div>
                              <button type="submit" class="btn btn-primary">Submit</button>
                            </form>
                          </div>
                        </div>


                     {% if comments %}
                        {% for comment in comments %}

                                  <!-- Single Comment -->

                            <div class="media mb-4">
                                {% if comment.comment_by.picture %}
                                        <img src="{{ comment.comment_by.picture.url }}"
                                             width="50" height="50"
                                             alt="Profile Picture"
                                             class="d-flex mr-3 rounded-circle">
                                    {% else %}
                                        <img src="/media/user_images/placeholder.png" width="50" height="50"
                                             alt="Placer Holder Image"
                                             class="d-flex mr-3 rounded-circle">

                                {% endif %}

                              <div class="media-body">
                                <h5 class="mt-0"><a href="{% url 'users:profile' slug=comment.comment_by.slug %}">
                                                         @{{ comment.comment_by }}</a></h5>
                                {{ comment.comment }}
                              </div>
                                {% if comment.comment_by == user or user.is_superuser %}
                                    <form action="{% url 'blog:comment_delete' comment.uuid %}" method="POST"
                                          class="mb-2 mr-sm-2">{% csrf_token %}
                                        <button type="submit" class="btn btn-danger btn-sm float-right">Delete</button>
                                    </form>
                                {% endif %}
                            </div>

                        {% endfor %}
                    {% endif %}



        </div>
        <!-- /.col -->

    </div>
    <!-- /.row -->

  </div>
<!-- /.container -->


{% endblock %}